<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compile a specialized data frame based on the <code>rvtable</code> package — dist_data â€¢ snaputils</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  <link href="../extra.css" rel="stylesheet">
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46129458-3', 'auto');
  ga('send', 'pageview');

</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">snaputils</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/snaputils.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-globe fa-lg"></span>
     
    SNAPverse
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://leonawicz.github.io/sv.html">Home of the verse</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Sector packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapverse">snapverse</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snaplite">snaplite</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdata">snapdata</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapwebs">snapwebs</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Functions packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapstat">snapstat</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapplot">snapplot</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snaplocs">snaplocs</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapprep">snapprep</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/alfresco">alfresco</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Data packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapclim">snapclim</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapfire">snapfire</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snappoly">snappoly</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapgrid">snapmaps</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdist">snapdist</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Apps &amp; docs packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapapps">snapapps</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdash">snapdash</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapflex">snapflex</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdocs">snapdocs</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Satellite packages</li>
    <li>
      <a href="https://leonawicz.github.io/rvtable">rvtable</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/apputils">apputils</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/maputils">maputils</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snaputils">snaputils</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapmeta">snapmeta</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapsite">snapsite</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/leonawicz/snaputils">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compile a specialized data frame based on the <code>rvtable</code> package</h1>
    </div>

    
    <p>Compile a specialized data frame based on the <code>rvtable</code> package using distribution data frames of SNAP downscaled climate data.</p>
    

    <pre class="usage"><span class='fu'>dist_data</span>(<span class='no'>data</span>, <span class='no'>variable</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>year_range</span>, <span class='no'>rcp_min_yr</span>, <span class='no'>base_max_yr</span>, <span class='no'>all_models</span>, <span class='kw'>baseline_model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>composite</span> <span class='kw'>=</span> <span class='st'>"Composite GCM"</span>, <span class='kw'>baseline_scenario</span> <span class='kw'>=</span> <span class='st'>"Historical"</span>,
  <span class='kw'>general_scenario</span> <span class='kw'>=</span> <span class='st'>"Projected"</span>, <span class='kw'>margin_drop</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='no'>baseline_scenario</span>,
  <span class='no'>baseline_model</span>), <span class='kw'>density_size</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>margin_size</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>sample_size</span> <span class='kw'>=</span> <span class='no'>margin_size</span>, <span class='kw'>limit_sample</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>baseline_only</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data frame. It does not need to be an <code>rvtable</code>-class data frame in advance, but it must be coercible to one.</p></td>
    </tr>
    <tr>
      <th>variable</th>
      <td><p>character, a valid random variable. See details for currently available options.</p></td>
    </tr>
    <tr>
      <th>margin</th>
      <td><p>variable to marginalize over. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>numeric or <code>NULL</code> (default), set random seed for reproducible sampling in app.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p><code>NULL</code> or logical. Output data in metric units, otherwise in US Standard. Input data in <code>data</code> is assumed metric.
If <code>NULL</code> (default), no conversion or climate variable-specific rounding is performed.</p></td>
    </tr>
    <tr>
      <th>year_range</th>
      <td><p>full range of years in data set.</p></td>
    </tr>
    <tr>
      <th>rcp_min_yr</th>
      <td><p>minimum year for RCP, e.g., for CMIP5 data this is 2006.</p></td>
    </tr>
    <tr>
      <th>base_max_yr</th>
      <td><p>maximum year for baseline historical comparison data set
that sometimes accompanies GCM data (e.g., CRU observation-based data, version 4.0 is 2015)</p></td>
    </tr>
    <tr>
      <th>all_models</th>
      <td><p>character, vector of climate model names in data set, to include baseline model if present.</p></td>
    </tr>
    <tr>
      <th>baseline_model</th>
      <td><p>character, name of baseline model in data set, e.g., <code>"CRU 4.0"</code>.</p></td>
    </tr>
    <tr>
      <th>composite</th>
      <td><p>character, name to use for composite climate models after marginalizing over models.</p></td>
    </tr>
    <tr>
      <th>baseline_scenario</th>
      <td><p>character, defaults to <code>"Historical"</code>.</p></td>
    </tr>
    <tr>
      <th>general_scenario</th>
      <td><p>character, defaults to <code>"Projected"</code>.</p></td>
    </tr>
    <tr>
      <th>margin_drop</th>
      <td><p>levels of variables to exclude from marginalizing operations on those variables.
Defaults to the baseline scenario and baseline model.</p></td>
    </tr>
    <tr>
      <th>density_size</th>
      <td><p>numeric, sample size for density estimations. Defaults to <code>200</code>.</p></td>
    </tr>
    <tr>
      <th>margin_size</th>
      <td><p>numeric, sample size for marginalizing operations. Defaults to <code>100</code>.</p></td>
    </tr>
    <tr>
      <th>sample_size</th>
      <td><p>numeric, sample size for density estimations. Defaults to <code>margin.size</code>.</p></td>
    </tr>
    <tr>
      <th>limit_sample</th>
      <td><p>logical, see details.</p></td>
    </tr>
    <tr>
      <th>baseline_only</th>
      <td><p>logical, only processing baseline data set. Useful for climatology data.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>logical, include progress bar in app.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a specialized data frame</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is a specialized function suited to preparing reactive data frames for an app where the upstream source data represents
an <code>rvtable</code>-class probability density data frame from the <code>rvtable</code> package.
Many such data frames of SNAP data are available.</p>
<p>This function assumes the presence of certain data frame columns: Val, Prob, Var, RCP, Model, and Year.
It will insert a Decade column. It will check to ensure a valid Var column, meaning a data frame can contain only
one unique variable in its Var ID column and it must currently be one of <code>"pr", "tas", "tasmin", "tasmax"</code>.
This is because the current implementation makes certain assumptions about the data based on presently existing realistic use cases.</p>
<p>A powerful feature of this function, given an appropriate <code>rvtable</code> data frame, is the ability to marginalize over
categorical variables (and meaningfully discrete numeric variables such as year) using the <code>margin</code> argument.
The current implementation allows marginalizing over RCPs and/or climate models.</p>
<p>Arguments such as <code>variable</code> and <code>year.range</code> can be determined internally with <code>data</code> directly,
but in the app context these variables are already determined in the session environment
and there is no need to repeat scans of large data frames columns with every call to <code>dist_data</code>.</p>
<p>Note that during marginalizing operations, baseline historical data sets are not integrated with climate models when integrating models
and historical climate models years are not integrated with future projections when integrating RCPs.
All categorical variables are factors with explicit levels, not character.</p>
<p>If <code>limit.sample=TRUE</code> (default), the final sample size is reduced by a factor proportional to the number of unique RCP-GCM pairs.
This helps prevent massive in-app samples when users select large amounts of data from many RCPs and models.
A minimum sample size per group is still maintained regardless of how much data is requested.
Detailed progress is provided for sampling from distributions and for calculating marginal distributions.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>#not run
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://leonawicz.github.io/'>Matthew Leonawicz</a>, <a href='http://snap.uaf.edu/'><img src="https://raw.githubusercontent.com/leonawicz/leonawicz.github.io/master/assets/img/snap_symbol.svg?sanitize=true" height="24" />  Scenarios Network for Alaska and Arctic Planning</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
